<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Write</title>
    <link rel="icon" type="image/png" href="/icons/noun_project_817.ico"/>
    <script>
      window.addEventListener('storage', function(e) {
        if(e.key=='LibreDocsState') {
          console.log('LibreDocsState '+e.newValue+' received');
          if(e.newValue == 'exit') {
            window.close();
          } else if(e.newValue == 'offline') {
            document.getElementById('spinner').style.display='block';
          } else {
            document.getElementById('spinner').style.display='none';
          }
        } else if(e.key == 'text') {
          displayText();
        }
      }, false);
      function displayText() {
        if(localStorage.getItem('text') != null) {
          document.getElementById('text').value=localStorage.getItem('text');
        }
      }
    </script>
    <style>
      * { padding:0; margin:0; border:0; outline:0; }
      html { overflow-x:hidden; overflow-y:hidden; }
      textarea { position:absolute; padding:10% 20%; font:1.5em FreeSans,Helvetica,sans-serif; color:#333; background:#eee; text-shadow:0 0 1px #666677; width:60%; height:80%; overflow-x:hidden; overflow-y:auto; resize:none; }
    </style>

  </head>
  <body onload="displayText();">
    <textarea id="text" onkeyup="localStorage.setItem('text', this.value);" autofocus></textarea>
  </body>
</html>
